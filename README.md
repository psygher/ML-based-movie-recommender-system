# ML-based-movie-recommender-system

# Movie Recommender System Documentation

## Overview

This document outlines a movie recommender system implemented in Python. The system utilizes a content-based approach in conjunction with collaborative filtering to suggest movies that are similar to a user's input. Additionally, it features a network visualization of the recommendations.

## Table of Contents

1. [Dependencies](#dependencies)
2. [Data Preprocessing](#data-preprocessing)
3. [Feature Engineering](#feature-engineering)
4. [Similarity Calculation](#similarity-calculation)
5. [Recommendation Generation](#recommendation-generation)
6. [Visualization](#visualization)
7. [Main Execution Flow](#main-execution-flow)

## 1. Dependencies

The system depends on several Python libraries:

- **pandas**: For data manipulation and analysis
- **numpy**: For numerical operations
- **scikit-learn**: For machine learning functions (TF-IDF vectorization, Nearest Neighbors)
- **nltk**: For natural language processing tasks (handling stopwords)
- **networkx**: For constructing graphs and collaborative filtering
- **pyvis**: For visualizing the recommendation network graph
- **streamlit**: For creating an interactive user interface

## 2. Data Preprocessing

### 2.1 Data Loading and Merging

The `load_and_preprocess_data` function manages the initial data preparation:

- Loads data from two CSV files: one containing movie metadata and the other containing cast and crew details.
- Merges the datasets based on movie ID to consolidate relevant features (genres, cast, crew, etc.).
- Addresses missing values by filling them with suitable defaults.

### 2.2 Feature Parsing

The system extracts valuable information from complex JSON-like columns:

- **Genres**: Extracts genre names from nested dictionaries.
- **Cast**: Extracts the names of the top three cast members.
- **Crew**: Extracts crew member names.

These features are combined into a single `combined_features` column for similarity calculations.

## 3. Feature Engineering

### 3.1 Combined Features

The `combined_features` column is generated by merging genres, cast, crew, movie overview, and keywords, with increased emphasis on the overview and keywords.

### 3.2 Text Vectorization

The `create_tfidf_matrix` function generates a TF-IDF (Term Frequency-Inverse Document Frequency) matrix from the `combined_features` column, facilitating effective similarity calculations.

## 4. Similarity Calculation

### 4.1 Nearest Neighbors

The system employs the Nearest Neighbors algorithm to identify similar movies based on TF-IDF vectors. Cosine similarity measures the similarity between movies, allowing the identification of the top similar movies for each input movie.

## 5. Recommendation Generation

The `get_recommendations` function produces movie recommendations by:

1. Locating the ID of the movie selected by the user.
2. Performing collaborative filtering with the Nearest Neighbors graph.
3. Filtering and sorting the most similar movies based on similarity scores.
4. Returning the top N movie recommendations to the user.

## 6. Visualization

### 6.1 Graph Visualization

The `visualize_graph` function illustrates the recommendation graph:

- A network graph is constructed using **NetworkX** and visualized with **Pyvis**.
- The input movie is highlighted in red, while recommended movies appear in green.
- The graph is embedded within the Streamlit interface for display.

## 7. Main Execution Flow

The `main` function orchestrates the application flow:

1. Loads and preprocesses the data.
2. Creates a TF-IDF matrix and builds a similarity graph using Nearest Neighbors.
3. Offers an interactive interface with **Streamlit**, allowing users to select a movie and receive recommendations.
4. Displays the movie recommendations and visualizes the relationships between similar movies.

## Conclusion

This movie recommender system employs a hybrid strategy that combines content-based filtering with collaborative signals from Nearest Neighbors. It also provides a graph-based visualization to enhance user experience by visually mapping similar movies.
